<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>业务小技巧 | LeoLiu BLOG</title>
    <meta name="description" content="LeoLiu 一个不断尝试新事情 学习新技术的80后">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta property="og:type" content="article">
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta name="applicable-device" content="pc,mobile">
    
    <link rel="preload" href="/assets/css/0.styles.c64e1613.css" as="style"><link rel="preload" href="/assets/js/app.5c0bf17f.js" as="script"><link rel="preload" href="/assets/js/3.ee9aa927.js" as="script"><link rel="preload" href="/assets/js/2.667d2a76.js" as="script"><link rel="preload" href="/assets/js/128.7560c2c4.js" as="script"><link rel="prefetch" href="/assets/js/10.a2a10f9d.js"><link rel="prefetch" href="/assets/js/100.12e226f6.js"><link rel="prefetch" href="/assets/js/101.7c0b719b.js"><link rel="prefetch" href="/assets/js/102.1cbc4c6d.js"><link rel="prefetch" href="/assets/js/103.73be63e2.js"><link rel="prefetch" href="/assets/js/104.f2f365e9.js"><link rel="prefetch" href="/assets/js/105.ec6c13c0.js"><link rel="prefetch" href="/assets/js/106.91984aee.js"><link rel="prefetch" href="/assets/js/107.6686f819.js"><link rel="prefetch" href="/assets/js/108.bf394f15.js"><link rel="prefetch" href="/assets/js/109.d22088cb.js"><link rel="prefetch" href="/assets/js/11.9e5ea4ec.js"><link rel="prefetch" href="/assets/js/110.c20b6ea6.js"><link rel="prefetch" href="/assets/js/111.3632dc26.js"><link rel="prefetch" href="/assets/js/112.b2964d55.js"><link rel="prefetch" href="/assets/js/113.95b726c7.js"><link rel="prefetch" href="/assets/js/114.02e77227.js"><link rel="prefetch" href="/assets/js/115.184029a3.js"><link rel="prefetch" href="/assets/js/116.7d290fac.js"><link rel="prefetch" href="/assets/js/117.3b0745c7.js"><link rel="prefetch" href="/assets/js/118.b095fd9e.js"><link rel="prefetch" href="/assets/js/119.d3b38a95.js"><link rel="prefetch" href="/assets/js/12.dd24e700.js"><link rel="prefetch" href="/assets/js/120.3ef41816.js"><link rel="prefetch" href="/assets/js/121.0ba45dfe.js"><link rel="prefetch" href="/assets/js/122.e20b8874.js"><link rel="prefetch" href="/assets/js/123.e5850cf1.js"><link rel="prefetch" href="/assets/js/124.939cec60.js"><link rel="prefetch" href="/assets/js/125.2f66c617.js"><link rel="prefetch" href="/assets/js/126.bfe2e28e.js"><link rel="prefetch" href="/assets/js/127.6da743ea.js"><link rel="prefetch" href="/assets/js/129.abd76f00.js"><link rel="prefetch" href="/assets/js/13.d3f1cc44.js"><link rel="prefetch" href="/assets/js/130.a01eaa8c.js"><link rel="prefetch" href="/assets/js/131.3b19d657.js"><link rel="prefetch" href="/assets/js/14.a093dbee.js"><link rel="prefetch" href="/assets/js/15.fd227849.js"><link rel="prefetch" href="/assets/js/16.e29b8647.js"><link rel="prefetch" href="/assets/js/17.3b1dde10.js"><link rel="prefetch" href="/assets/js/18.b65dfd5d.js"><link rel="prefetch" href="/assets/js/19.778d3597.js"><link rel="prefetch" href="/assets/js/20.3a0bbfad.js"><link rel="prefetch" href="/assets/js/21.03b6970c.js"><link rel="prefetch" href="/assets/js/22.36e3d031.js"><link rel="prefetch" href="/assets/js/23.26d58bb6.js"><link rel="prefetch" href="/assets/js/24.d4311330.js"><link rel="prefetch" href="/assets/js/25.f28e82fa.js"><link rel="prefetch" href="/assets/js/26.d3631968.js"><link rel="prefetch" href="/assets/js/27.d7260db1.js"><link rel="prefetch" href="/assets/js/28.945c8c0f.js"><link rel="prefetch" href="/assets/js/29.093d0bdd.js"><link rel="prefetch" href="/assets/js/30.5211032e.js"><link rel="prefetch" href="/assets/js/31.5726f5ce.js"><link rel="prefetch" href="/assets/js/32.40a53f7d.js"><link rel="prefetch" href="/assets/js/33.e562ccf5.js"><link rel="prefetch" href="/assets/js/34.0836396f.js"><link rel="prefetch" href="/assets/js/35.b7a24af8.js"><link rel="prefetch" href="/assets/js/36.09670ded.js"><link rel="prefetch" href="/assets/js/37.59a59f70.js"><link rel="prefetch" href="/assets/js/38.85972ebc.js"><link rel="prefetch" href="/assets/js/39.f0ac8a02.js"><link rel="prefetch" href="/assets/js/4.71fda8ea.js"><link rel="prefetch" href="/assets/js/40.4a568031.js"><link rel="prefetch" href="/assets/js/41.0a90fa38.js"><link rel="prefetch" href="/assets/js/42.462aadb9.js"><link rel="prefetch" href="/assets/js/43.db3d86b2.js"><link rel="prefetch" href="/assets/js/44.c4cf0795.js"><link rel="prefetch" href="/assets/js/45.42142065.js"><link rel="prefetch" href="/assets/js/46.2203db22.js"><link rel="prefetch" href="/assets/js/47.c547be6f.js"><link rel="prefetch" href="/assets/js/48.ac86e3f4.js"><link rel="prefetch" href="/assets/js/49.1689f956.js"><link rel="prefetch" href="/assets/js/5.c37833ab.js"><link rel="prefetch" href="/assets/js/50.2cf5308c.js"><link rel="prefetch" href="/assets/js/51.e49a054e.js"><link rel="prefetch" href="/assets/js/52.5a3ec44d.js"><link rel="prefetch" href="/assets/js/53.d797d3f6.js"><link rel="prefetch" href="/assets/js/54.65fdef31.js"><link rel="prefetch" href="/assets/js/55.014f028a.js"><link rel="prefetch" href="/assets/js/56.0b42842d.js"><link rel="prefetch" href="/assets/js/57.39563f76.js"><link rel="prefetch" href="/assets/js/58.b96306fb.js"><link rel="prefetch" href="/assets/js/59.80c04014.js"><link rel="prefetch" href="/assets/js/6.944fd0b9.js"><link rel="prefetch" href="/assets/js/60.7cb55bdd.js"><link rel="prefetch" href="/assets/js/61.1a017b7d.js"><link rel="prefetch" href="/assets/js/62.ce7eeed9.js"><link rel="prefetch" href="/assets/js/63.19297071.js"><link rel="prefetch" href="/assets/js/64.1af32bf2.js"><link rel="prefetch" href="/assets/js/65.29e67f71.js"><link rel="prefetch" href="/assets/js/66.98c1d46b.js"><link rel="prefetch" href="/assets/js/67.4df91a09.js"><link rel="prefetch" href="/assets/js/68.235a4fea.js"><link rel="prefetch" href="/assets/js/69.4c8be215.js"><link rel="prefetch" href="/assets/js/7.bf948e03.js"><link rel="prefetch" href="/assets/js/70.66c988dc.js"><link rel="prefetch" href="/assets/js/71.cf54b3a2.js"><link rel="prefetch" href="/assets/js/72.e2713f73.js"><link rel="prefetch" href="/assets/js/73.86eb5488.js"><link rel="prefetch" href="/assets/js/74.1d0386da.js"><link rel="prefetch" href="/assets/js/75.67562454.js"><link rel="prefetch" href="/assets/js/76.b25ab917.js"><link rel="prefetch" href="/assets/js/77.ac5fe662.js"><link rel="prefetch" href="/assets/js/78.bbd94a78.js"><link rel="prefetch" href="/assets/js/79.e72883ce.js"><link rel="prefetch" href="/assets/js/8.c3bc25e4.js"><link rel="prefetch" href="/assets/js/80.27aa1c7b.js"><link rel="prefetch" href="/assets/js/81.0f47afa1.js"><link rel="prefetch" href="/assets/js/82.61f8755e.js"><link rel="prefetch" href="/assets/js/83.384d836f.js"><link rel="prefetch" href="/assets/js/84.0686252e.js"><link rel="prefetch" href="/assets/js/85.5b30ee32.js"><link rel="prefetch" href="/assets/js/86.965e3f65.js"><link rel="prefetch" href="/assets/js/87.ab1a4506.js"><link rel="prefetch" href="/assets/js/88.a1ba7856.js"><link rel="prefetch" href="/assets/js/89.9ff5f3ef.js"><link rel="prefetch" href="/assets/js/9.2c895704.js"><link rel="prefetch" href="/assets/js/90.d4d11699.js"><link rel="prefetch" href="/assets/js/91.c384b102.js"><link rel="prefetch" href="/assets/js/92.9e4ebbed.js"><link rel="prefetch" href="/assets/js/93.b23b1b35.js"><link rel="prefetch" href="/assets/js/94.d42ded59.js"><link rel="prefetch" href="/assets/js/95.77d0b725.js"><link rel="prefetch" href="/assets/js/96.5fd82eda.js"><link rel="prefetch" href="/assets/js/97.35a9f18f.js"><link rel="prefetch" href="/assets/js/98.aa773431.js"><link rel="prefetch" href="/assets/js/99.8e19aa12.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c64e1613.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">LeoLiu BLOG</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Note</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/" class="nav-link">VuePress</a></li><li class="dropdown-item"><!----> <a href="/markdown/" class="nav-link">Markdown</a></li><li class="dropdown-item"><!----> <a href="/ide/" class="nav-link">IDE</a></li><li class="dropdown-item"><!----> <a href="/web/" class="nav-link router-link-active">Web</a></li><li class="dropdown-item"><!----> <a href="/android/" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/ios/" class="nav-link">iOS</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/server/" class="nav-link">Server</a></li><li class="dropdown-item"><!----> <a href="/unity/" class="nav-link">Unity</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/ktangel/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://ktangel.github.io/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ago Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Note</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress/" class="nav-link">VuePress</a></li><li class="dropdown-item"><!----> <a href="/markdown/" class="nav-link">Markdown</a></li><li class="dropdown-item"><!----> <a href="/ide/" class="nav-link">IDE</a></li><li class="dropdown-item"><!----> <a href="/web/" class="nav-link router-link-active">Web</a></li><li class="dropdown-item"><!----> <a href="/android/" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/ios/" class="nav-link">iOS</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/server/" class="nav-link">Server</a></li><li class="dropdown-item"><!----> <a href="/unity/" class="nav-link">Unity</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/ktangel/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://ktangel.github.io/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ago Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/web/" class="sidebar-link">Web 前端开发</a></li><li><a href="/web/html/" class="sidebar-link">Html</a></li><li><a href="/web/css/" class="sidebar-link">css</a></li><li><a href="/web/js/" class="sidebar-link">JS</a></li><li><a href="/web/vue/" class="sidebar-link">vue</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="业务小技巧"><a href="#业务小技巧" aria-hidden="true" class="header-anchor">#</a> 业务小技巧</h1> <h2 id="菜单元素或输入元素在页面隐藏。"><a href="#菜单元素或输入元素在页面隐藏。" aria-hidden="true" class="header-anchor">#</a> 菜单元素或输入元素在页面隐藏。</h2> <h3 id="显示更多按钮函数"><a href="#显示更多按钮函数" aria-hidden="true" class="header-anchor">#</a> 显示更多按钮函数</h3> <div class="language-js extra-class"><pre class="language-js"><code>fn<span class="token punctuation">.</span><span class="token function-variable function">morecon</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">self<span class="token punctuation">,</span> el<span class="token punctuation">,</span> el2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//更多查询条件显示条</span>
    <span class="token keyword">var</span> _width <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">':visible'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slideUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        el2 <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>_width <span class="token operator">&lt;</span> <span class="token number">1800</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">$</span><span class="token punctuation">(</span>el2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">':visible'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">$</span><span class="token punctuation">(</span>el2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slideUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;More&amp;nbsp;&lt;i class='fa fa-angle-double-down'&gt;&lt;/i&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slideDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        el2 <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>el2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">':visible'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">$</span><span class="token punctuation">(</span>el2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slideDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;More&amp;nbsp;&lt;i class='fa fa-angle-double-up'&gt;&lt;/i&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="绑定元素代码"><a href="#绑定元素代码" aria-hidden="true" class="header-anchor">#</a> 绑定元素代码</h3> <p>.more-condition显示更多按钮
.other-conditions响应式隐藏
.other-conditionsev大分辨率时总是显示</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.more-conditions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.more-conditions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        edawfn<span class="token punctuation">.</span><span class="token function">morecon</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;.other-conditions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.more-conditionsev&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.more-conditionsev&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        edawfn<span class="token punctuation">.</span><span class="token function">morecon</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;.other-conditionsev&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.other-conditions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>*CSS样式：</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.other-conditions</span> <span class="token punctuation">{</span>
<span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">padding-top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.date-cont</span> <span class="token punctuation">{</span>
<span class="token property">display</span><span class="token punctuation">:</span> none<span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token property">visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.other-conditionsev</span> <span class="token punctuation">{</span>
<span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token property">padding-top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.date-contev</span> <span class="token punctuation">{</span>
<span class="token property">display</span><span class="token punctuation">:</span> none<span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token property">visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.more-conditionsev</span> <span class="token punctuation">{</span>
<span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token property">visibility</span><span class="token punctuation">:</span> visible<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.more-conditions</span> <span class="token punctuation">{</span>
<span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token property">visibility</span><span class="token punctuation">:</span> visible<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>##提示框</p> <ul><li><strong>对带有占位符的输入元素，在输入框有内容时，将预提示信息显示在提示框中</strong></li></ul> <p>控制函数:</p> <div class="language-js extra-class"><pre class="language-js"><code>fn<span class="token punctuation">.</span>placeTip <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> wdiv <span class="token operator">=</span> <span class="token string">&quot;&lt;div class='place-wrap'&gt;&lt;/div&gt;&quot;</span><span class="token punctuation">,</span>
        _self<span class="token punctuation">,</span>
        span <span class="token operator">=</span> <span class="token string">&quot;&lt;span class='place-text'&gt;&lt;/span&gt;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> cacheTip <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//缓存已加Tip的元素，也可以用类查。</span>
    <span class="token keyword">var</span> <span class="token function-variable function">_fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">els</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _self <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>els<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_self<span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _fn<span class="token punctuation">.</span><span class="token function">In</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>els<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _fn<span class="token punctuation">.</span><span class="token function">Out</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    _fn<span class="token punctuation">.</span><span class="token function-variable function">In</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> popwrap <span class="token operator">=</span> _self<span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">'place-wrap'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            h <span class="token operator">=</span> _self<span class="token punctuation">.</span><span class="token function">outerHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">,</span>
            _tex <span class="token operator">=</span> <span class="token punctuation">(</span>_self<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'placeholder'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            margin <span class="token operator">=</span> _self<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;margin-bottom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>popwrap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            _self<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>wdiv<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;height&quot;</span><span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            margin <span class="token operator">&amp;&amp;</span> _self<span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;margin-bottom&quot;</span><span class="token punctuation">,</span> margin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            cacheTip<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>_self<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _self<span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>span<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>_tex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            hasframe <span class="token operator">&amp;&amp;</span> _self<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&quot;iframe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hasframe<span class="token punctuation">,</span> _self<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _self<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    _fn<span class="token punctuation">.</span><span class="token function-variable function">Out</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> spa <span class="token operator">=</span> _self<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            con <span class="token operator">=</span> spa<span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">&quot;title-wrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>con<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            spa<span class="token punctuation">.</span><span class="token function">fadeOut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    _fn<span class="token punctuation">.</span><span class="token function-variable function">Clear</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span>cacheTip<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span> el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            el<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>CSS样式：</p> <div class="language-css extra-class"><pre class="language-css"><code>    <span class="token selector">.place-wrap</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.place-text</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 2px <span class="token property">left</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 1px 6px<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid transparent<span class="token punctuation">;</span>
    <span class="token property">border-top-left-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token property">border-top-right-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>226<span class="token punctuation">,</span> 79<span class="token punctuation">,</span> 73<span class="token punctuation">,</span> 0.75<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span>768px <span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">.iframe.place-text</span> <span class="token punctuation">{</span>
    <span class="token property">top</span><span class="token punctuation">:</span> -24px<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 40%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 992px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">.place-text</span> <span class="token punctuation">{</span>
    <span class="token property">top</span><span class="token punctuation">:</span> -24px<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0px<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token atrule"><span class="token rule">@media</span> only screen and <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 1800px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">.place-text</span> <span class="token punctuation">{</span>
    <span class="token property">right</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> -24px<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="icheke小插件的值获取和设置"><a href="#icheke小插件的值获取和设置" aria-hidden="true" class="header-anchor">#</a> iCheke小插件的值获取和设置</h2> <p>提供参数name为元素属性名</p> <div class="language-js extra-class"><pre class="language-js"><code>fn<span class="token punctuation">.</span><span class="token function-variable function">getRadioValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> el <span class="token operator">=</span> <span class="token string">'input[name='</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">']:checked'</span><span class="token punctuation">,</span>
        _data<span class="token punctuation">;</span>
    _data <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _data<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
fn<span class="token punctuation">.</span><span class="token function-variable function">setRadioValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> el <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'input[name='</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'][value='</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">']'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    el<span class="token punctuation">.</span><span class="token function">iCheck</span><span class="token punctuation">(</span><span class="token string">&quot;check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="webkit"><a href="#webkit" aria-hidden="true" class="header-anchor">#</a> webkit</h2> <h3 id="打包发布"><a href="#打包发布" aria-hidden="true" class="header-anchor">#</a> 打包发布</h3> <p>经过一整天各种填坑，大晚上的总算是把webkit的web app顺利发布并在XP系统下也跑通了。
现在来梳理一下遇到过的问题，先介绍下环境。</p> <p>APP的环境及主要功能：</p> <ol><li>APP版本自动更新：node-webkit-updater插件；安装方法： <code>npm install node-webkit-builder -g</code> ；项目地址： <code>https://github.com/edjafarov/node-webkit-updater</code>。</li> <li>主要业务代码在服务器，通过iframe加载入口，本地只有提示音文件和消息提示功能代码。</li> <li>消息提示：当有新订单时弹消息提示，并同时播放提示音。这个是重点功能，因这个功能而挖坑比较多，我用的是webkit标准化之后的Notification方法，比较新的浏览器都支持，也正因此出现了调试过程一切顺利，打包后一但调用此方法就出现程序崩溃，反复调试后发现是打包插件的版本太低（1.2.1），下载1.2.2和1.2.3重新打包后就正常了。</li> <li>因需要隐藏地址栏工具栏，于是自己做了个前进、后退、刷新功能的新导航栏。</li> <li>支持iframe间的跨域传数据，这里用到的是postMessage方法，既然webkit支持很多最新的浏览器特性，咱就不用费工夫去用一些所谓兼容好方法了，postMessage有很大一个好处，它是通过全局&quot;message&quot;事件来把数据传送过去，对于实现功能非常方便，于是我通过对传递信息进行定义转换，实现了跨域子母页面之间互相调用方法并可以传递执行参数。</li></ol> <p>问题汇总：</p> <ul><li>消息推送：在做它的API方法时，刚开始使用的是第一次握手后缓存对方的e.source(发送方的window全局对象），跨域环境下它是只读的，而且不可被引用，在这里可以把它缓存作后面的postmessage的回传用，在后来发现了这种握手式方法的缺点：换页面或reload刷新环境后需要子页面重新握手初始化API环境；我这里只用了一个iframe，所以后来就不缓存它了，省去握手的问题，父传子可以通过getifrmae DOM对象的contentWindow引用POSTMSG过去，而子传父的话就直接用命top.postMeassage传递。以后有需要再去尝试多级iframe的方法。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//消息推送函数</span>
<span class="token keyword">function</span> <span class="token function">postmsg</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> pram<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fn<span class="token punctuation">.</span>appwin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">setappwin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">var</span> _msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msg <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> toarr <span class="token operator">=</span> _msg<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;()&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>toarr <span class="token operator">||</span> pram<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> msgobj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
				msgobj<span class="token punctuation">.</span>fn <span class="token operator">=</span> toarr <span class="token operator">?</span> _msg<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> _msg<span class="token punctuation">;</span>
				msgobj<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;fn&quot;</span><span class="token punctuation">;</span>
				pram <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>msgobj<span class="token punctuation">.</span>pram <span class="token operator">=</span> pram<span class="token punctuation">)</span><span class="token punctuation">;</span>
				_msg <span class="token operator">=</span> msgobj<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				_msg<span class="token punctuation">.</span>callback <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				callback<span class="token punctuation">.</span>fn <span class="token operator">=</span> _msg<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
				<span class="token function">push_callback</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			fn<span class="token punctuation">.</span>appwin <span class="token operator">&amp;&amp;</span> fn<span class="token punctuation">.</span>appwin<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>_msg<span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token comment">//</span>
<span class="token keyword">var</span> apprun <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token function-variable function">back</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">postmsg</span><span class="token punctuation">(</span><span class="token string">&quot;hiback&quot;</span><span class="token punctuation">)</span> <span class="token comment">//为了急着解决问题，我自己约定好关键字，执行在frame中判断。；</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function-variable function">forward</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">postmsg</span><span class="token punctuation">(</span><span class="token string">&quot;hiforward&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token function-variable function">reload</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">postmsg</span><span class="token punctuation">(</span><span class="token string">&quot;reload&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

初始化
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>appwin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> appbody <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;appbody&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		appbody<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'hi,init'</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//初始化握手；</span>
	<span class="token punctuation">}</span>
<span class="token comment">//添加事件处理；</span>
	window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>data <span class="token operator">===</span> <span class="token string">&quot;hi,appinit&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token operator">!</span>window<span class="token punctuation">.</span>appwin <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>appwin <span class="token operator">=</span> e<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token function">manage_msg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;for appwin msg:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="子iframe使用到的函数"><a href="#子iframe使用到的函数" aria-hidden="true" class="header-anchor">#</a> 子iframe使用到的函数</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">function</span> <span class="token function">postmsg</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> pram<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> _msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msg <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> toarr <span class="token operator">=</span> _msg<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;()&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>toarr <span class="token operator">||</span> pram<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> msgobj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
			msgobj<span class="token punctuation">.</span>fn <span class="token operator">=</span> toarr <span class="token operator">?</span> _msg<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> _msg<span class="token punctuation">;</span>
			msgobj<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;fn&quot;</span><span class="token punctuation">;</span>
			pram <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>msgobj<span class="token punctuation">.</span>pram <span class="token operator">=</span> pram<span class="token punctuation">)</span><span class="token punctuation">;</span>
			_msg <span class="token operator">=</span> msgobj<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			_msg<span class="token punctuation">.</span>callback <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			callback<span class="token punctuation">.</span>fn <span class="token operator">=</span> _msg<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
			<span class="token function">push_callback</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		top<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>_msg<span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

	<span class="token keyword">function</span> <span class="token function">initpost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		top<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'hi,appinit'</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token comment">//添加对message事件处理；</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;for parntwin msg:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>data <span class="token operator">===</span> <span class="token string">&quot;hi,init&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token operator">!</span>window<span class="token punctuation">.</span>parentwin <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>parentwin <span class="token operator">=</span> e<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">postmsg</span><span class="token punctuation">(</span><span class="token string">&quot;hi,appinit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token function">manage_msg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">//由子窗口初始化握手，好告诉父子窗口已经换页。</span>
<span class="token function">initpost</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="然后是处理msg消息的方法"><a href="#然后是处理msg消息的方法" aria-hidden="true" class="header-anchor">#</a> 然后是处理msg消息的方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">manage_msg</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msg <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&quot;fn&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//执行函数</span>
				<span class="token keyword">var</span> _fn <span class="token operator">=</span> msg<span class="token punctuation">.</span>fn<span class="token punctuation">,</span>
					type <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>_fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">var</span> _pram <span class="token operator">=</span> msg<span class="token punctuation">.</span>pram <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
				<span class="token keyword">var</span> ptype <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>_pram<span class="token punctuation">)</span><span class="token punctuation">;</span>
				msgfn <span class="token operator">=</span> _fn<span class="token punctuation">;</span>
				msgcallback <span class="token operator">=</span> msg<span class="token punctuation">.</span>callback <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
				<span class="token comment">//记录现在调用的fn名，POST callback时带上</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>msgself<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//msgself是对是否可以直接运行其它函数的开关，true时允许直接访问运行全局下的所有函数；false时禁止，只允许运行预设的函数。</span>
						<span class="token keyword">switch</span> <span class="token punctuation">(</span>_fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">case</span> <span class="token string">&quot;opencef&quot;</span><span class="token punctuation">:</span>
								<span class="token function">opencef</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>pram<span class="token punctuation">)</span><span class="token punctuation">;</span>
								<span class="token keyword">break</span><span class="token punctuation">;</span>
							<span class="token keyword">case</span> <span class="token string">&quot;webopenie&quot;</span><span class="token punctuation">:</span>
								<span class="token function">webopenie</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>pram<span class="token punctuation">)</span><span class="token punctuation">;</span>
								<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
						_pram <span class="token operator">?</span> <span class="token function">eval</span><span class="token punctuation">(</span>_fn<span class="token punctuation">)</span><span class="token punctuation">[</span>ptype <span class="token operator">!==</span> <span class="token string">'array'</span> <span class="token operator">?</span> <span class="token string">'call'</span> <span class="token punctuation">:</span> <span class="token string">'apply'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> _pram<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">eval</span><span class="token punctuation">(</span>_fn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'data'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//这里可以放数据的处理方法，比如只是简单的回调数据</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> msg <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;{&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
				<span class="token keyword">switch</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">case</span> <span class="token string">&quot;hiback&quot;</span><span class="token punctuation">:</span>
						window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token keyword">case</span> <span class="token string">&quot;hiforward&quot;</span><span class="token punctuation">:</span>
						window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token keyword">case</span> <span class="token string">&quot;reload&quot;</span><span class="token punctuation">:</span>
						window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token keyword">case</span> <span class="token string">&quot;notfiy&quot;</span><span class="token punctuation">:</span> <span class="token comment">//测试消息推送是否可用；</span>
						<span class="token function">startPlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">break</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/30/2019, 1:22:05 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5c0bf17f.js" defer></script><script src="/assets/js/3.ee9aa927.js" defer></script><script src="/assets/js/2.667d2a76.js" defer></script><script src="/assets/js/128.7560c2c4.js" defer></script>
  </body>
</html>
